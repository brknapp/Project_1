---
title: "Project 1"
---

```{r render, echo = FALSE, eval = FALSE}
rmarkdown::render("README.Rmd",
                  output_format = "github_document",
                  output_options = list(
                      toc = TRUE,
                      html_preview=FALSE) 
)
```

# Lets Get Started: OMDb API Key

In order to access the OMDb API, you need to get a free [api key](http://www.omdbapi.com/apikey.aspx). In the rest of this document, "mykey" refers to your OMDb API key.

You should also "turn on" these packages by running the code below. If you don't have them installed yet, run `install.packages()` with the package in quotes. For example, to install `tidyverse`, you would run `install.packages("tidyverse")`.

```{r 7_03_6_22_2022}
library(httr) #this package will help use use the URL we built to get information from the OMDb API
library(jsonlite) #this package will help us convert the data we get from the OMDb API to a more usable format
library(tidyverse) #this package will help us work with our nicely formatted data.
```

In order to get information from the OMDb API, we have to build a URL with our search criteria. It's similar to doing a Google search. There are two ways to build a URL: "By ID or Title" or "By Search".

# Build URL for One Movie Title

Let's say you have a movie title in mind, like Star Wars (1977). Here's a function you can use to get data from the OMDb API about Star Wars:

Note: the parameter “type” has three options: movie, series, and episode. If “type” is not specified, it will give everything (including movies, series, and episodes). I’m making the default for “type” be “movie”, but you can change this if you want.

```{r search_by_title_Star_Wars}
search_by_title <- function(mykey,title,type="movie"){
  base_url <- paste0("http://www.omdbapi.com/?apikey=",mykey)
  info_url <- paste0("&t=",title,"&type=",type) 
  full_url <- paste0(base_url, info_url)
  full_url <- gsub(full_url, pattern = " ", replacement = "%20")
  
  movie_api_call <- GET(full_url)
  movie_api_call_char <- rawToChar(movie_api_call$content)
  movie_JSON <- jsonlite::fromJSON(movie_api_call_char, flatten = TRUE) 
  movie_JSON <- as.data.frame(movie_JSON)
  tibble_movie_JSON <- as_tibble(movie_JSON)
  return(tibble_movie_JSON)
}
```

You should run the function like this:

```{r 3_50_6_21_2022,eval=FALSE}
search_by_title("mykey","star_wars",type="movie")
```


You should get a tibble that looks like this:

```{r example_search_by_title_Star_Wars, eval=TRUE, echo=FALSE}
search_by_title("5c7f9206","star_wars",type="movie")
```

# Build URL for One Movie Title and One Date

If you don't specify a date, the OMDb API will give the first result. So, since Star Wars (1977) was the first Star Wars movie ever made, it gives Star Wars (1977) as the result. But, what if you wanted a different Star Wars movie like Star Wars: Episode VII - The Force Awakens (2015)? You can use this funciton:

```{r 7_11_6_22_2022}
search_by_title_and_date <- function(mykey,title,type="movie",date){
  base_url <- paste0("http://www.omdbapi.com/?apikey=",mykey)
  info_url <- paste0("&t=",title,"&type=",type,"&y=",date) 
  full_url <- paste0(base_url, info_url)
  full_url <- gsub(full_url, pattern = " ", replacement = "%20")
  
  movie_api_call <- GET(full_url)
  movie_api_call_char <- rawToChar(movie_api_call$content)
  movie_JSON <- jsonlite::fromJSON(movie_api_call_char, flatten = TRUE) 
  movie_JSON <- as.data.frame(movie_JSON)
  tibble_movie_JSON <- as_tibble(movie_JSON)
  return(tibble_movie_JSON)
}
```


You should run the function like this:

```{r 8_00_6_22_2022,eval=FALSE}
search_by_title_and_date("mykey","star_wars",type="movie",date=2015)
```

Get a tibble like this:

```{r 7_13_6_22_2022,eval=TRUE,echo=FALSE}
search_by_title_and_date("5c7f9206","star_wars",type="movie",date=2015)
```

# Build URL for One IMDb ID

Lets say you have a valid IMDb ID. You can find an IMDb ID by searching for a title on the [IMDb website](www.imdb.com). After you find a movie you like, the IMDb ID will be in the URL. For example, the URL for the IMDb page for Star Wars: Episode V - The Empire Strikes Back (1980) is https://www.imdb.com/title/tt0080684/?ref_=nv_sr_srsg_0. Therefore, its IMDb ID is tt0080684.

Here's a function you can use if you have a valid IMDb ID:

```{r search_by_IMDb_ID_Star_Wars, message=FALSE,warning=FALSE}
library(tidyverse)
library(jsonlite)
library(httr)
search_by_IMDb_ID <- function(mykey,IMDb_ID,type="movie"){
  base_url <- paste0("http://www.omdbapi.com/?apikey=",mykey)
  info_url <- paste0("&i=",IMDb_ID,"&type=",type) 
  full_url <- paste0(base_url, info_url)
  full_url <- gsub(full_url, pattern = " ", replacement = "%20")
  
  movie_api_call <- GET(full_url)
  movie_api_call_char <- rawToChar(movie_api_call$content)
  movie_JSON <- jsonlite::fromJSON(movie_api_call_char, flatten = TRUE) 
  movie_JSON <- as.data.frame(movie_JSON)
  tibble_movie_JSON <- as_tibble(movie_JSON)
  return(tibble_movie_JSON)
}
```

You should run the function like this:

```{r 3_54_6_21_2022,eval=FALSE}
search_by_IMDb_ID("mykey","tt0080684",type="movie")
```

You should get a tibble that looks like this:

```{r example_search_by_IMDb_ID_Star_Wars, eval=TRUE, echo=FALSE}
search_by_IMDb_ID("5c7f9206","tt0080684",type="movie")
```

# Build URL to Search for More than One Title in a Series

Let's say you wanted to get all of the titles for all of the Star Wars movies. You would then need to build your URL "By Search" instead. Here's a function you can use if you wanted to search for multiple movie titles:

```{r by_search, message=FALSE,warning=FALSE}
by_search_series <- function(mykey,title,type="movie"){
  base_url <- paste0("http://www.omdbapi.com/?apikey=",mykey)
  info_url <- paste0("&s=",title,"&type=",type) 
  full_url <- paste0(base_url, info_url)
  full_url <- gsub(full_url, pattern = " ", replacement = "%20")
  
  movie_api_call <- GET(full_url)
  movie_api_call_char <- rawToChar(movie_api_call$content)
  movie_JSON <- jsonlite::fromJSON(movie_api_call_char, flatten = TRUE) 
  movie_JSON <- as.data.frame(movie_JSON)
  tibble_movie_JSON <- as_tibble(movie_JSON)
  return(tibble_movie_JSON)
}
```

You should run the function like this:

```{r 3_57_6_21_2022,eval=FALSE}
by_search_series("mykey","star_wars",type="movie")
```

You should get a tibble that looks like this:

```{r example_by_search, eval=TRUE, echo=FALSE}
by_search_series("5c7f9206","star_wars",type="movie")
```

# Get the data!

That's great! Now, lets get the data for all of the titles:

```{r get_data}
mat=NULL
get_data_series <- function(mykey,title){
  temp_table <- by_search_series(mykey,title,type="movie")
  list_of_titles <- unique(temp_table$Search.Title)
  
  for(movie_title in list_of_titles){
  table <- search_by_title(mykey,movie_title,type="movie")
  mat=rbind(mat,table)
  }
  return(mat)
}
```

You should run the function like this:

```{r 8_54_6_22_2022,eval=FALSE}
get_data_series("mykey","star_wars")
```

You should get a tibble that looks like this:

```{r example_get_data,eval=TRUE,echo=FALSE}
get_data_series("5c7f9206","star_wars")
```

# Build URL to search for More than One Title or Series

Now, what if you want to get all of the data for all of the Star Wars movies and all of the Indiana Jones movies. The function below can handle a list of several titles or one title.

```{r test_3_35_6_20_2022}
mat=NULL
by_search_one_or_more_titles <- function(mykey,title,type="movie"){
 if(length(title)<=1){ 
  base_url <- paste0("http://www.omdbapi.com/?apikey=",mykey)
    info_url <- paste0("&s=",title,"&type=",type) 
    full_url <- paste0(base_url, info_url)
    full_url <- gsub(full_url, pattern = " ", replacement = "%20")
    
    movie_api_call <- GET(full_url)
    movie_api_call_char <- rawToChar(movie_api_call$content)
    movie_JSON <- jsonlite::fromJSON(movie_api_call_char, flatten = TRUE) 
    movie_JSON <- as.data.frame(movie_JSON)
    movie_JSON <- as_tibble(movie_JSON)
    return(movie_JSON)
 }
  if(length(title)>1){
  for(i in title){
  base_url <- paste0("http://www.omdbapi.com/?apikey=",mykey)
  info_url <- paste0("&s=",i,"&type=",type) 
  full_url <- paste0(base_url, info_url)
  full_url <- gsub(full_url, pattern = " ", replacement = "%20")
  
  movie_api_call <- GET(full_url)
  movie_api_call_char <- rawToChar(movie_api_call$content)
  movie_JSON <- jsonlite::fromJSON(movie_api_call_char, flatten = TRUE) 
  movie_JSON <- as.data.frame(movie_JSON)
  mat=rbind(mat,movie_JSON)
  mat=as_tibble(mat)
  }
    }
  return(mat)
}
```

You can use this new by_search function to look for multiple titles or just one. For example, if you wanted to search for both Star Wars and Indiana Jones, you would run the function like this:

```{r ex_test_3_50_6_20_2022,eval=FALSE}
by_search_one_or_more_titles("mykey",c("star_wars","indiana_jones"),type="movie")
```

You would get the tibble below: 

```{r ex_test_3_35_6_20_2022,eval=TRUE,echo=FALSE}
by_search_one_or_more_titles("5c7f9206",c("star_wars","indiana_jones"),type="movie")
```

If you wanted to search for one title, like Spider-Man, you would run the function like this:

```{r ex_test_3_54_6_20_2022,eval=FALSE}
by_search_one_or_more_titles("mykey","spider-man",type="movie")
```

You would get this tibble:

```{r 9_04_6_22_2022,eval=TRUE,echo=FALSE}
by_search_one_or_more_titles("5c7f9206","spider-man",type="movie")
```

Now, lets get all of the data for both Star Wars and Indiana Jones:

```{r 9_03_6_22_2022}
mat=NULL
get_data_one_or_more_titles <- function(mykey,title){
  temp_table <- by_search_one_or_more_titles(mykey,title,type="movie")
  list_of_titles <- unique(temp_table$Search.Title)
  
  for(movie_title in list_of_titles){
  table <- search_by_title(mykey,movie_title,type="movie")
  mat=rbind(mat,table)
  }
  return(mat)
}
```

You would run the function like this:

```{r 9_05_6_22_2022,eval=FALSE}
get_data_one_or_more_titles("mykey",c("star_wars","indiana_jones"))
```


```{r test_5_11_6_20_2022}
get_data_one_or_more_titles("5c7f9206",c("star_wars","indiana_jones"))
```

Before we can analyze this data, we need to make it more usable:

```{r 6:01_6_20_2022}
format_data <- function(mykey,title){
  data <- get_data(mykey,title)
  
  
  
  
}





```



movie title in mind, like Star Wars. Here's a function you can use to get data from the OMDb API about Star Wars:



This is my .Rmd file. Test. Test 2

```{r plot}
plot(iris)
```